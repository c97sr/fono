# Check the first few entries to ensure proper formatting
head(data$epi_year_week_padded)
# Append "-1" to denote the first day of the week (Monday)
data$correct_dates <- as.Date(paste(data$epi_year_week_padded, "1", sep="-"), format="%Y-%W-%u")
# Check for any NAs or conversion errors
summary(data$correct_dates)
data$epi_week <- epitools::as.week(data$correct_dates)
data$correct_dates <- as.Date(paste(data$epi_year_week_padded, "1", sep="-"), format="%Y-%W-%u")
# Ensure the correct format for weeks starting from 1 (as %W starts from 00 in R)
data$correct_dates <- as.Date(paste0(data$epi_year_week_padded, "-1"), format="%Y-%W-%u")
# Checking the first few entries to ensure they are correct
head(data$correct_dates)
# Ensure the correct format for weeks starting from 1 (as %W starts from 00 in R)
data$correct_dates <- as.Date(paste0(data$epi_year_week_padded, "-1"), format="%Y-%W-%u")
# Checking the first few entries to ensure they are correct
head(data$correct_dates)
data$epi_year_week_padded <- sprintf("%s-%02d",
substr(data$epi_year_week, 1, 4),  # Extract the year part
as.numeric(substr(data$epi_year_week, 6, 7)))  # Extract the week part correctly
data$epi_year_week_padded
epiweekToDate(2013,34)
install.packages("EpiWeek")
library(EpiWeek)
library(epiweek)
data <- read_norovirus_data(dataset =1, main_sheet_index = 2)
nsmo = 9
plot <- plot_cases_w_boxcar(data, nsmo = nsmo, ytit = global_ytit)
print(plot)
data <- read_norovirus_data(dataset =2, main_sheet_index = 1)
data
nsmo = 9
plot <- plot_cases_w_boxcar(data, nsmo = nsmo, ytit = global_ytit)
print(plot)
#-----------------------------------------------------------------------------
# Plotting with vertical lines at t1 and t2
y_max = 30
annotated_plot <- add_annotations(plot, t1, t2, R0_text, annotate_date = t1+90, y_max)
print(annotated_plot)
t1 <- as.Date("2018-09-01")
t2 <- as.Date("2018-12-01")
R0 <- calc_r0(t1, t2, data)
R0_text <- sprintf("R0 = %.2f", R0)
y_max = 30
annotated_plot2 <- add_annotations(annotated_plot, t1, t2, R0_text, annotate_date = t1+30, y_max)
print(annotated_plot2)
nsmo = 9
plot <- plot_cases_w_boxcar(data, nsmo = nsmo, ytit = global_ytit)
print(plot)
#-----------------------------------------------------------------------------
# Now calculate R0 assumming exponential growth between t1 and t2
t1 <- as.Date("2017-07-24")
t2 <- as.Date("2017-12-15")
R0 <- calc_r0(t1, t2, data)
R0_text <- sprintf("R0 = %.2f", R0)
#-----------------------------------------------------------------------------
# Plotting with vertical lines at t1 and t2
y_max = 30
annotated_plot <- add_annotations(plot, t1, t2, R0_text, annotate_date = t1+90, y_max)
print(annotated_plot)
t1 <- as.Date("2018-09-01")
t2 <- as.Date("2018-12-01")
R0 <- calc_r0(t1, t2, data)
R0_text <- sprintf("R0 = %.2f", R0)
annotated_plot2 <- add_annotations(annotated_plot, t1, t2, R0_text, annotate_date = t1+30, y_max)
print(annotated_plot2)
t1 <- as.Date("2022-10-15")
t2 <- as.Date("2023-03-01")
R0 <- calc_r0(t1, t2, data)
R0_text <- sprintf("R0 = %.2f", R0)
annotated_plot3 <- add_annotations(annotated_plot2, t1, t2, R0_text, annotate_date = t1+30, y_max)
print(annotated_plot3)
plot_ps <- plot_power_spectrum(data, npeak = 3)  # Adjust npeak as needed
print(plot_ps)
plot <- plot_sarima_forecast(data, forecast_length = 12)
smoothed_data <- apply_boxcar_average(data, nsmo = 9, edge_truncate=TRUE)
prediction_dates <- as.Date(c("2017-07-01", "2018-01-01", "2018-07-01"))
prediction_dates <- as.Date(c("2017-03-01", "2017-10-01", "2018-04-01","2018-12-01"))
plot <- plot_sarima_forecasts(smoothed_data, prediction_dates, forecast_length = 12)
plot <- detect_change_points_cusum(smoothed_data, threshold = 3)
print(plot)
plot <- detect_growth_rate_changes(smoothed_data, threshold = 20)
plot <- detect_change_points_growth_rate(smoothed_data, threshold = 0.5)
plot <- detect_change_points_pelt(smoothed_data, penalty = "Manual", pen.value = 24)
print(plot)
devtools::document()
devtools::install
devtools::install
devtools::install
plot <- identify_onset_exponential_rise(data)
print(plot)
plot_rise_1 <- identify_onset_exponential_rise_1(data, nsmo = 9)
plot_rise_1 <- identify_onset_exponential_rise_1(data, nsmo = 9)
devtools::document()
devtools::install
plot_rise_1 <- identify_onset_exponential_rise_1(data, nsmo = 9)
print(plot_rise_1)
plot <- identify_onset_exponential_rise(data, nsmo = 9, threshold_multiplier = 1)
print(plot)
devtools::document()
plot <- identify_onset_exponential_rise(data, nsmo = 9, threshold_multiplier = 1)
print(plot)
plot <- identify_onset_exponential_rise(data, nsmo = 9, threshold_multiplier = 1)
plot <- identify_onset_exponential_rise(data, nsmo = 9, threshold_multiplier = 2)
plot <- identify_onset_exponential_rise(data, nsmo = 9, threshold_multiplier = 1)
print(plot)
plot <- identify_onset_exponential_rise(data, nsmo = 9, threshold_multiplier = 2)
print(plot)
plot <- identify_onset_exponential_rise(data, nsmo = 15, threshold_multiplier = 1)
plot <- identify_onset_exponential_rise(data, nsmo = 15, threshold_multiplier = 1.5)
print(plot)
devtools::document()
plot <- identify_troughs(data, nsmo = 9)
print(plot)
plot <- identify_onset_exponential_rise(data, nsmo = 9, threshold_multiplier = 2)
print(plot)
plot <- identify_troughs(data, nsmo = 15)
print(plot)
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot <- identify_troughs(data, nsmo = 15)
print(plot)
plot <- identify_troughs(data, nsmo = 9)
print(plot)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot <- identify_troughs(data, nsmo = 15)
print(plot)
plot <- identify_troughs(data, nsmo = 8)
print(plot)
plot <- identify_troughs(data, nsmo = 5)
print(plot)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot <- identify_troughs(data, nsmo = 8)
print(plot)
plot <- identify_troughs(data, nsmo = 3)
print(plot)
plot <- identify_troughs(data, nsmo = 20)
print(plot)
plot <- identify_troughs(data, nsmo = 15)
print(plot)
plot <- identify_troughs(data, nsmo = 12)
print(plot)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot <- identify_troughs(data, nsmo = 12)
print(plot)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot <- identify_troughs(data, nsmo = 12)
print(plot)
plot <- identify_troughs(data, nsmo = 18)
print(plot)
plot <- identify_troughs(data, nsmo = 24)
print(plot)
rm(list=ls())
graphics.off()
library(R.matlab)
install.packages("R.matlab")
library(R.matlab)
library(lubridate)
library(dplyr)
library(gridExtra)
library(reshape2)
install.packages("reshape2")
library(lubridate)
library(dplyr)
library(gridExtra)
library(reshape2)
source('util.R')
pwd
$pwd
rm(list=ls())
graphics.off()
library(R.matlab)
library(ggplot2)
library(lubridate)
library(dplyr)
library(gridExtra)
library(reshape2)
source('util.R')
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data <- read_norovirus_data(dataset =1, main_sheet_index = 2)
data()
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data <- read_norovirus_data(dataset =1, main_sheet_index = 2)
data <- read_norovirus_data(dataset =2, main_sheet_index = 1)
data <- read_norovirus_data(dataset =1, main_sheet_index = 2)
devtools::document()
devtools::install()
1
data <- read_norovirus_data(dataset =1, main_sheet_index = 2)
data
data <- read_norovirus_data(dataset =2, main_sheet_index = 1)
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
data1
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
data()
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
data$epi_year_week_padded
epitools::as.week(data$epi_year_week_padded)
as.week(data$epi_year_week_padded)
sum(is.na(data$epi_year_week_padded))
head(data$epi_year_week_padded)
install.packages("ISOweek")
library(ISOweek)
data$date <- ISOweek2date(paste0(data$epi_year_week_padded, "-1"))
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
my_data$date <- as.numeric(epitools::as.week(my_data$epi_year_week_padded))
my_data <- data.frame(epi_year_week_padded = c("2017-52", "2017-51", "2017-50", "2017-49", "2017-48", "2017-47"))
as.Date(paste0(data$epi_year_week_padded, "-1"), format = "%Y-%W-%u")
paste0(data$epi_year_week_padded, "-1")
paste0(data$epi_year_week_padded
)
as.Date(paste0(my_data$epi_year_week_padded, "-1"), format = "%Y-%W-%u")
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
my_data$epi_year_week_padded
as.Date(paste0(my_data$epi_year_week_padded, "-1"), format = "%Y-%W-%u")
my_data$epi_week2 <- as.numeric(epitools::as.week(my_data$epi_year_week_padded))
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
my_data$epi_week <- as.Date(paste0(my_data$epi_year_week_padded, "-1"), format = "%Y-%W-%u")
my_data <- my_data[order(my_data$epi_year_week), ]
my_data
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
data
my_dat
data1
data2
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
data4anal = data1
nsmo = 9
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
data4anal = data2
# Plot the data with a smoothed line
nsmo = 9
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal <- data.frame(
x = seq(1, 10, length.out = 10),
y = c(1, 4, 6, 8, 5, 7, 10, 9, 11, 12)
)
data4anal
spline_data_default <- fit_spline(data4anal)
# Fit spline with specified number of splines (e.g., 5)
spline_data_specified <- fit_spline(data4anal, num_splines = 5)
print(spline_data_default)
print(spline_data_specified)
data4anal = data2
spline_data_default <- fit_spline(data4anal)
data4anal
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_default <- fit_spline(data4anal)
data4anal$count
data4anal$epi_week
data4anal = data1
spline_data_default <- fit_spline(data4anal)
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_default <- fit_spline(data4anal)
plot(spline_data_default)
spline_data_specified
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
spline_data_specified <- fit_spline(data4anal, num_splines = 5)
date4anal
date1
data1$epi_week
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
spline_data_default <- fit_spline(data4anal)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_default <- fit_spline(data4anal)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_default <- fit_spline(data4anal)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_default <- fit_spline(data4anal)
data4anal$epi_week
data4anal$epi_week <- as.Date(data4anal$epi_week)
y <- data4anal$count
dates <- data4anal$epi_week
dates
spline_fit <- smooth.spline(y ~ dates)
y_spline <- predict(spline_fit, dates)$y
spline_fit
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_specified <- fit_spline(data4anal, num_splines = 5)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_specified <- fit_spline(data4anal, num_splines = 5)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_default <- fit_spline(data4anal)
q
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_specified <- fit_spline(data4anal, num_splines = 5)
spline_data_specified <- fit_spline(data4anal, num_splines = 10)
spline_data_specified <- fit_spline(data4anal, num_splines = 20)
spline_data_specified <- fit_spline(data4anal, num_splines = 40)
spline_data_specified
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_specified <- fit_spline(data4anal, num_splines = 20)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_specified <- fit_spline(data4anal, num_splines = 20)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = 20)
data4anal_rev$count_spline
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
my_data
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
my_data$epi_year_week_padded
as.week(my_data$epi_year_week_padded)
as.Date(paste0(my_data$epi_year_week_padded, "-1"), format = "%Y-%W-%u")
my_data$epi_year_week_padded
my_data$epi_year_week_padded
epitools::as.week(my_data$epi_year_week_padded)
epitools::as.date(my_data$epi_year_week_padded)
epitools::as.Date(my_data$epi_year_week_padded)
install.packages("MMWRweek")
library(MMWRweek)
epiYear = as.integer(substr(my_data$epi_year_week_padded, 1, 4))
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
epiYear = as.integer(substr(my_data$epi_year_week_padded, 1, 4))
epiWeek = as.integer(substr(my_data$epi_year_week_padded, 6, 7))
dateResult <- MMWRweek::MMWRweek2Date(MMWRyear = epiYear, MMWRweek = epiWeek, MMWRday = 1)
dateResult
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
data4anal_rev <- fit_spline(data4anal, num_splines = 20)
data4anal = data2
data4anal_rev <- fit_spline(data4anal, num_splines = 20)
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
data4anal = data1
size(data1)
length(data1)
nrow(data1)
nrow(data2)
round(nrow(data4anal))*4
round(nrow(data4anal)/100)
round(nrow(data4anal)/100)*20
round(nrow(data4anal)/100)*40
data4anal = data1
nrow(data1)
round(nrow(data4anal)/25)*40
round(nrow(data4anal)/25)
round(nrow(data4anal)/5)
round(nrow(data4anal)/100)
round(nrow(data4anal)/100)*20
round(nrow(data2)/100)*20
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
data4anal = data1
nspline = round(nrow(data4anal)/100)*20
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*25
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*25
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
data4anal = data2
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*50
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*35
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*25
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*20
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*10
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*20
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*15
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*10
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*5
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
data4anal_rev$count_spline
install.packages("WaveletComp")
library(WaveletComp)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_wavelet_heatmap(data4anal$count, dt = 1)
plot_wavelet_heatmap(data4anal$count, dt = 1)
time_series = data4anal$count
time_series
plot_wavelet_heatmap(time_series, dt = 1)
# Example usage
# Generate a sample time series
set.seed(123)
time_series <- cumsum(rnorm(100))
time_series
# Plot the wavelet heat map
plot_wavelet_heatmap(time_series)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_wavelet_heatmap(data4anal, dt = 1)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_wavelet_heatmap(data4anal_rev, dt = 1)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
time_series = data4anal$count
plot_wavelet_heatmap(time_series, dt = 1)
time_series
library(WaveletComp)
# Example data: integer time series
time_series <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
# Convert the time series vector into a data frame
my_data <- data.frame(time_series)
colnames(my_data) <- "count"
# Compute the wavelet transform
wavelet_result <- analyze.wavelet(my_data, "count", dt = 1)
# Print the wavelet result
print(wavelet_result)
# Extract the wavelet power spectrum
power_spectrum <- wavelet_result$Power
# Create a data frame for plotting
time_index <- seq_along(time_series)
frequency <- wavelet_result$Period
power_df <- expand.grid(Time = time_index, Frequency = frequency)
power_df$Power <- as.vector(t(power_spectrum))
# Plot the heat map using ggplot2
heatmap_plot <- ggplot(power_df, aes(x = Time, y = Frequency, fill = Power)) +
geom_tile() +
scale_fill_gradientn(colors = rev(heat.colors(256))) +
labs(title = "Wavelet Power Spectrum", x = "Time Index", y = "Frequency") +
theme_minimal()
# Print the plot
print(heatmap_plot)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_wavelet_heatmap(time_series, dt = 1)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_wavelet_heatmap(time_series, dt = 1)
time_series
time_series = data4anal$count
plot_wavelet_heatmap(time_series, dt = 1)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_wavelet_heatmap(time_series, dt = 1)
time_series = data4anal_rev$count_spline
plot_wavelet_heatmap(time_series, dt = 1)
time_series = data4anal$count
plot_wavelet_heatmap(time_series, dt = 1)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_wavelet_heatmap(time_series, dt = 1)
