library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_default <- fit_spline(data4anal)
data4anal$count
data4anal$epi_week
data4anal = data1
spline_data_default <- fit_spline(data4anal)
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_default <- fit_spline(data4anal)
plot(spline_data_default)
spline_data_specified
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
spline_data_specified <- fit_spline(data4anal, num_splines = 5)
date4anal
date1
data1$epi_week
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
spline_data_default <- fit_spline(data4anal)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_default <- fit_spline(data4anal)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_default <- fit_spline(data4anal)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_default <- fit_spline(data4anal)
data4anal$epi_week
data4anal$epi_week <- as.Date(data4anal$epi_week)
y <- data4anal$count
dates <- data4anal$epi_week
dates
spline_fit <- smooth.spline(y ~ dates)
y_spline <- predict(spline_fit, dates)$y
spline_fit
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_specified <- fit_spline(data4anal, num_splines = 5)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_specified <- fit_spline(data4anal, num_splines = 5)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_default <- fit_spline(data4anal)
q
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_specified <- fit_spline(data4anal, num_splines = 5)
spline_data_specified <- fit_spline(data4anal, num_splines = 10)
spline_data_specified <- fit_spline(data4anal, num_splines = 20)
spline_data_specified <- fit_spline(data4anal, num_splines = 40)
spline_data_specified
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_specified <- fit_spline(data4anal, num_splines = 20)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
spline_data_specified <- fit_spline(data4anal, num_splines = 20)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = 20)
data4anal_rev$count_spline
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
my_data
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
my_data$epi_year_week_padded
as.week(my_data$epi_year_week_padded)
as.Date(paste0(my_data$epi_year_week_padded, "-1"), format = "%Y-%W-%u")
my_data$epi_year_week_padded
my_data$epi_year_week_padded
epitools::as.week(my_data$epi_year_week_padded)
epitools::as.date(my_data$epi_year_week_padded)
epitools::as.Date(my_data$epi_year_week_padded)
install.packages("MMWRweek")
library(MMWRweek)
epiYear = as.integer(substr(my_data$epi_year_week_padded, 1, 4))
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
epiYear = as.integer(substr(my_data$epi_year_week_padded, 1, 4))
epiWeek = as.integer(substr(my_data$epi_year_week_padded, 6, 7))
dateResult <- MMWRweek::MMWRweek2Date(MMWRyear = epiYear, MMWRweek = epiWeek, MMWRday = 1)
dateResult
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
data4anal_rev <- fit_spline(data4anal, num_splines = 20)
data4anal = data2
data4anal_rev <- fit_spline(data4anal, num_splines = 20)
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
data4anal = data1
size(data1)
length(data1)
nrow(data1)
nrow(data2)
round(nrow(data4anal))*4
round(nrow(data4anal)/100)
round(nrow(data4anal)/100)*20
round(nrow(data4anal)/100)*40
data4anal = data1
nrow(data1)
round(nrow(data4anal)/25)*40
round(nrow(data4anal)/25)
round(nrow(data4anal)/5)
round(nrow(data4anal)/100)
round(nrow(data4anal)/100)*20
round(nrow(data2)/100)*20
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
data4anal = data1
nspline = round(nrow(data4anal)/100)*20
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*25
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*25
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
data4anal = data2
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*50
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*35
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*25
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*20
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*10
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*20
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*15
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*10
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*5
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
data4anal_rev$count_spline
install.packages("WaveletComp")
library(WaveletComp)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_wavelet_heatmap(data4anal$count, dt = 1)
plot_wavelet_heatmap(data4anal$count, dt = 1)
time_series = data4anal$count
time_series
plot_wavelet_heatmap(time_series, dt = 1)
# Example usage
# Generate a sample time series
set.seed(123)
time_series <- cumsum(rnorm(100))
time_series
# Plot the wavelet heat map
plot_wavelet_heatmap(time_series)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_wavelet_heatmap(data4anal, dt = 1)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_wavelet_heatmap(data4anal_rev, dt = 1)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
time_series = data4anal$count
plot_wavelet_heatmap(time_series, dt = 1)
time_series
library(WaveletComp)
# Example data: integer time series
time_series <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
# Convert the time series vector into a data frame
my_data <- data.frame(time_series)
colnames(my_data) <- "count"
# Compute the wavelet transform
wavelet_result <- analyze.wavelet(my_data, "count", dt = 1)
# Print the wavelet result
print(wavelet_result)
# Extract the wavelet power spectrum
power_spectrum <- wavelet_result$Power
# Create a data frame for plotting
time_index <- seq_along(time_series)
frequency <- wavelet_result$Period
power_df <- expand.grid(Time = time_index, Frequency = frequency)
power_df$Power <- as.vector(t(power_spectrum))
# Plot the heat map using ggplot2
heatmap_plot <- ggplot(power_df, aes(x = Time, y = Frequency, fill = Power)) +
geom_tile() +
scale_fill_gradientn(colors = rev(heat.colors(256))) +
labs(title = "Wavelet Power Spectrum", x = "Time Index", y = "Frequency") +
theme_minimal()
# Print the plot
print(heatmap_plot)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_wavelet_heatmap(time_series, dt = 1)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_wavelet_heatmap(time_series, dt = 1)
time_series
time_series = data4anal$count
plot_wavelet_heatmap(time_series, dt = 1)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_wavelet_heatmap(time_series, dt = 1)
time_series = data4anal_rev$count_spline
plot_wavelet_heatmap(time_series, dt = 1)
time_series = data4anal$count
plot_wavelet_heatmap(time_series, dt = 1)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_wavelet_heatmap(time_series, dt = 1)
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
data4anal = data2
nsmo = 9
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
clicked_points <- capture_clicks()
plot(1:10, rnorm(10), pch = 19, col = "blue", main = "Click on This Plot")
clicked_points <- capture_clicks()
plot(1:10, rnorm(10), pch = 19, col = "blue", main = "Click on This Plot")
clicked_points <- capture_clicks()
plot(1:10, rnorm(10), pch = 19, col = "blue", main = "Click on This Plot")
clicked_points <- capture_clicks(n=10)
clicked_points
plot(1:10, rnorm(10), pch = 19, col = "blue", main = "Click on This Plot")
clicked_points <- capture_clicks()
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
nsmo = 9
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
clicked_points <- capture_clicks()
plot(1:10, rnorm(10), pch = 19, col = "blue", main = "Click on This Plot")
clicked_points <- capture_clicks()
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
clicked_points <- capture_clicks()
plot(data4anal_rev$count_spline)
clicked_points <- capture_clicks()
plot(data4anal_rev$epi_week, data4anal_rev$count_spline)
clicked_points <- capture_clicks()
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
nsmo = 9
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
clicked_points <- capture_clicks()
print,as.Date(clicked_points$x)
as.Date(clicked_points$x)
as.Date(clicked_points$x,origin = "1970-01-01")
clicked_points <- capture_clicks()
as.Date(clicked_points$x,origin = "1970-01-01")
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
nspline = round(nrow(data4anal)/100)*15
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
plot(data4anal_rev$count_spline)
clicked_points <- capture_clicks()
plot(data4anal_rev$epi_week, data4anal_rev$count_spline)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
nsmo = 9
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
nsmo = 21
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
nsmo = 15
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
clicked_points <- capture_clicks()
clicked_points <- capture_clicks()
i_max = c(16772.63,17136.74,17546.35,17984.93,18328.34,18742.09,19159.98,19486.85,19908.87)
i_min = c(16925.72,17310.51,17744.95,18129.74,18543.49,18866.22,19255.15,19664.76)
date_max = as.Date(i_max,origin = "1970-01-01")
date_min = as.Date(i_min,origin = "1970-01-01")
date_min
date_max
plot(data4anal$count)
plot(data4anal$count,type="line")
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot(data, type = "l", col = "blue", main = "Original Data with Moving Average",
xlab = "Index", ylab = "Count")
data <- data4anal$count
plot(data, type = "l", col = "blue", main = "Original Data with Moving Average",
xlab = "Index", ylab = "Count")
smoothed_data <- moving_average(data, n = 10)  # Adjust 'n' to specify the smoothing window
smoothed_data <- moving_average(data, n = 10)  # Adjust 'n' to specify the smoothing window
plot(data, type = "l", col = "blue", main = "Original Data with Moving Average",
xlab = "Index", ylab = "Count")
smoothed_data <- moving_average(data, n = 10)  # Adjust 'n' to specify the smoothing window
len(data)
length(data)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
nsmo = 15
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
data <- data4anal$count
plot(data, type = "l", col = "blue", main = "Original Data with Moving Average",
xlab = "Index", ylab = "Count")
smoothed_data <- moving_average(data, n = 10)  # Adjust 'n' to specify the smoothing window
lines(smoothed_data, col = "red", lwd = 2)  # 'lwd' is line width
legend("topright", legend = c("Original Data", "Smoothed Data"), col = c("blue", "red"), lty = 1, lwd = 2)
clicked_points <- capture_clicks()
clicked_points <- capture_clicks()
i_max = c(13.11921,60.40514,106.50893,170.93602,213.49336,274.37400,329.93497,376.03876,425.68899)
i_min = c(27.89606,87.59456,139.60909,191.03254,243.63814,291.51515,345.30290,399.68173)
round(i_min)
date_min = data4anal$epi_week[round(i_min)]
date_min
date_max = data4anal$epi_week[round(i_max)]
date_max
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
i_max = c(13.11921,60.40514,106.50893,170.93602,213.49336,274.37400,329.93497,376.03876,425.68899)
i_min = c(27.89606,87.59456,139.60909,191.03254,243.63814,291.51515,345.30290,399.68173)
date_min = data4anal$epi_week[round(i_min)]
date_max = data4anal$epi_week[round(i_max)]
plot_date_histograms(date_min, date_max)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_date_histograms(date_min, date_max)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_date_histograms(date_min, date_max)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_date_histograms(date_min, date_max)
nsmo = 15
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
t1 <- as.Date("2017-07-24")
t2 <- as.Date("2017-12-15")
R0 <- calc_r0(t1, t2, data4anal)
R0_text <- sprintf("R0 = %.2f", R0)
y_max = 30
annotated_plot <- add_annotations(plot, t1, t2, R0_text, annotate_date = t1+90, y_max)
print(annotated_plot)
t1 <- as.Date("2018-09-01")
t2 <- as.Date("2018-12-01")
R0 <- calc_r0(t1, t2, data4anal)
R0_text <- sprintf("R0 = %.2f", R0)
annotated_plot2 <- add_annotations(annotated_plot, t1, t2, R0_text, annotate_date = t1+30, y_max)
print(annotated_plot2)
t1 <- as.Date("2022-10-15")
t2 <- as.Date("2023-03-01")
R0 <- calc_r0(t1, t2, data4anal)
R0_text <- sprintf("R0 = %.2f", R0)
annotated_plot3 <- add_annotations(annotated_plot2, t1, t2, R0_text, annotate_date = t1+30, y_max)
print(annotated_plot3)
plot_ps <- plot_power_spectrum(data4anal, npeak = 3)  # Adjust npeak as needed
print(plot_ps)
plot <- plot_sarima_forecast(data4anal, forecast_length = 12)
print(plot)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot <- plot_sarima_forecast(data4anal, forecast_length = 12)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot <- plot_sarima_forecast(data4anal, forecast_length = 12)
smoothed_data <- apply_boxcar_average(data4anal, nsmo = 9, edge_truncate=TRUE)
prediction_dates <- as.Date(c("2017-07-01", "2018-01-01", "2018-07-01"))
prediction_dates <- as.Date(c("2017-03-01", "2017-10-01", "2018-04-01","2018-12-01"))
plot <- plot_sarima_forecasts(smoothed_data, prediction_dates, forecast_length = 12)
print(plot)
plot <- detect_change_points_cusum(smoothed_data, threshold = 3)
print(plot)
plot <- detect_growth_rate_changes(smoothed_data, threshold = 20)
plot <- detect_change_points_growth_rate(smoothed_data, threshold = 0.5)
plot <- detect_change_points_pelt(smoothed_data, penalty = "Manual", pen.value = 24)
print(plot)
plot_rise_1 <- identify_onset_exponential_rise_1(data4anal, nsmo = 9)
print(plot_rise_1)
plot <- identify_onset_exponential_rise(data4anal, nsmo = 9, threshold_multiplier = 2)
print(plot)
plot <- identify_troughs(data4anal, nsmo = 24)
print(plot)
nspline = round(nrow(data4anal)/100)*15
# Fit spline with specified number of splines (e.g., 5)
data4anal_rev <- fit_spline(data4anal, num_splines = nspline)
plot(data4anal_rev$count_spline)
plot(data4anal_rev$epi_week, data4anal_rev$count_spline)
time_series = data4anal$count
plot_wavelet_heatmap(time_series, dt = 1)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
time_series = data4anal$count
plot_wavelet_heatmap(time_series, dt = 1)
wavelet_result
length(power_spectrum)
length(power_spectrum$axis.2)
length(power_spectrum$axis)
length(power_spectrum)
length(power_spectrum$axis.2)
length(power_spectrum)
length(power_spectrum$Ridge)
length(power_spectrum$ridge)
dim(power_df$Power)
dim(power_df)
dim(power_df$Frequency)
wavelet_result$Period
dim(power_spectrum)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
q
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_wavelet_heatmap(data4anal, dt = 1)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_wavelet_heatmap(data4anal, dt = 1)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
plot_ps <- plot_power_spectrum(data4anal, npeak = 3)  # Adjust npeak as needed
print(plot_ps)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
install.packages("lubridate")
library(lubridate)
library(devtools)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
install.packages("MMWRweek")
library(MMWRweek)
data1 <- read_norovirus_data(dataset =1, main_sheet_index = 2)
data2 <- read_norovirus_data(dataset =2, main_sheet_index = 1)
data4anal = data2
# Plot the data with a smoothed line
nsmo = 15
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
t1 <- as.Date("2017-07-24")
t2 <- as.Date("2017-12-15")
R0 <- calc_r0(t1, t2, data4anal)
t1 <- as.Date("2017-07-24")
t2 <- as.Date("2017-12-15")
R0 <- calc_r0(t1, t2, data4anal)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
t1 <- as.Date("2017-07-24")
t2 <- as.Date("2017-12-15")
R0 <- calc_r0(t1, t2, data4anal)
R0_text <- sprintf("R = %.2f", R0)
nsmo = 15
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
nsmo = 9
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
nsmo = 3
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
load_all("/Users/pete/Dropbox/shared/CSMB03/norovirus-fl/fono")
nsmo = 3
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
nsmo = 11
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
nsmo = 31
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
nsmo = 15
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
nsmo = 9
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
nsmo = 21
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
nsmo = 15
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
nsmo = 9
plot <- plot_cases_w_boxcar(data4anal, nsmo = nsmo, ytit = global_ytit)
print(plot)
# Plotting with vertical lines at t1 and t2
y_max = 30
annotated_plot <- add_annotations(plot, t1, t2, R0_text, annotate_date = t1+90, y_max)
print(annotated_plot)
#-----------------------------------------------------------------------------
# add another R0 calculation
t1 <- as.Date("2018-09-01")
t2 <- as.Date("2018-12-01")
R0 <- calc_r0(t1, t2, data4anal)
R0_text <- sprintf("R = %.2f", R0)
annotated_plot2 <- add_annotations(annotated_plot, t1, t2, R0_text, annotate_date = t1+30, y_max)
print(annotated_plot2)
#-----------------------------------------------------------------------------
# add  third R0 calculation
t1 <- as.Date("2022-10-15")
t2 <- as.Date("2023-03-01")
R0 <- calc_r0(t1, t2, data4anal)
R0_text <- sprintf("R = %.2f", R0)
annotated_plot3 <- add_annotations(annotated_plot2, t1, t2, R0_text, annotate_date = t1+30, y_max)
print(annotated_plot3)
